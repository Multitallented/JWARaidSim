
<div class="container {{nation}}">

  <div class="right list-resources faction-bg">
    {{getPoints()}} pts | {{getOptions()}} opts
  </div>

  <div class="nation-select">
    <h3>Select Your Faction</h3>
    <a class="ru" (click)="selectNation('russian');">
      <img src="/assets/flags/ru.png" alt="Soviet Russia" />
    </a>
    <a class="de" (click)="selectNation('german');">
      <img src="/assets/flags/de.png" alt="Nazi Germany" />
    </a>
    <a class="us" (click)="selectNation('american');">
      <img src="/assets/flags/us.png" alt="United States" />
    </a>
    <a class="ja" (click)="selectNation('japanese');">
      <img src="/assets/flags/ja.png" alt="Imperial Japan" />
    </a>
    <a class="zh" (click)="selectNation('chinese');">
      <img src="/assets/flags/zh.png" alt="China" />
    </a>
    <a class="it" (click)="selectNation('italian');">
      <img src="/assets/flags/it.png" alt="Italy" />
    </a>
    <a class="uk" (click)="selectNation('british');">
      <img src="/assets/flags/uk.png" alt="British Commonwealth" />
    </a>
    <a class="ina" (click)="selectNation('indian');">
      <img src="/assets/flags/ina.png" alt="Indian National Army" />
    </a>
    <a class="fr" (click)="selectNation('french');">
      <img src="/assets/flags/fr.png" alt="France" />
    </a>
  </div>

  <div class="clearfix"></div>
  <div class="row" *ngIf="nation">
    <div class="col wdth-33">
      <h3>Options</h3>
      <div *ngFor="let platoonOption of getPlatoonOptions()">
        <span class="name">{{platoonOption.name}}</span>
        <a (click)="addPlatoon(platoonOption)">>></a>
      </div>
    </div>
    <div class="col wdth-33 chosen-platoons">
      <h3>Army</h3>
      <div class="platoon" *ngFor="let platoon of armyList">
        <ng-container *ngIf="armyList.length > 0 || platoon.standard">
          <div class="platoon-info">
            <span class="name">{{platoon.name}} {{platoon.getPoints()}}pts</span>
            <a class="platoon-accordian right" (click)="platoon.expanded = !platoon.expanded">{{platoon.expanded ? '--' : '+'}}</a>
            <a class="platoon-edit right" (click)="platoon.editing=!platoon.editing">{{platoon.editing ? 'Save' : 'Edit'}}</a>
          </div>
          <div class="platoon-squads" [ngClass]="{'expanded': platoon.expanded}">
            <div *ngFor="let squad of platoon.squads">
              <div *ngIf="platoon.editing || squad.included">
                <a (click)="viewSquad(squad, platoon)">{{squad.name}} {{squad.points}}pts</a>
                <a class="right" *ngIf="!squad.required" (click)="squad.included = !squad.included">{{squad.included ? 'Remove' : 'Add'}}</a>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
    <div class="col wdth-33">
      <h3>Unit <a class="right" (click)="frontSide = !frontSide">Flip Card</a></h3>
      <div *ngIf="activeSquad">
        <div class="active-squad" [ngClass]="{'front': frontSide}">
          <h2>{{activeSquad.name.split(' ')[0]}}
            <span *ngIf="activeSquad.name.indexOf(' ') !== -1">{{activeSquad.name.substring(activeSquad.name.indexOf(' '), activeSquad.name.length)}}</span></h2>
          <img class="card-icon" src="{{getCardIcon(activeSquad)}}" alt="Card Icon" />
          <div class="card-container">
            <div *ngIf="frontSide" class="card-front">
              <div class="main-image">
                <img src="{{activeSquad.data.img}}" alt="{{activeSquad.name}}" />
              </div>
              <div class="points-bar">
                <span *ngIf="activeSquad.data.hq" class="hq">HQ</span>
                <span class="points">{{activeSquad.points}}pts </span>
                <span *ngIf="activeSquad.data.options" class="options">{{activeSquad.data.options}}opts</span>
              </div>
              <div class="lore-container">
                <div *ngFor="let variant of activeSquad.data.variants" class="variant" (click)="toggleVariant(variant)">
                  <img class="unlock-icon" *ngIf="variant.selected" src="assets/common/unlock.png" alt="Unlocked" />
                  <img class="lock-icon" *ngIf="!variant.selected" src="assets/common/lock.png" alt="Unlocked" />
                  +{{variant.points}}pts <span [innerHTML]="replaceIcons(variant.name)"></span>
                </div>
                <div class="hr" *ngIf="activeSquad.data.lore"></div>
                <p *ngIf="activeSquad.data.lore">
                  {{activeSquad.data.lore}}
                </p>
                <p class="right" *ngIf="activeSquad.data.quote">
                  {{activeSquad.data.quote}}
                </p>
              </div>
            </div>
            <div *ngIf="!frontSide" class="card-back">
              <div class="infantry-group" *ngFor="let infantrySection of activeSquad.data.infantry">
                <h3>
                  <span *ngIf="infantrySection.models > 1">{{infantrySection.models}}x </span>
                  {{infantrySection.name}}
                </h3>
                <div *ngFor="let weapon of infantrySection.weapons">
                  <div *ngIf="weaponMap[weapon.name]" class="weapon">
                    <div class="weapon-bar">
                      <div class="right">
                        <span class="range">
                          <img src="assets/common/range.png" alt="Range" />
                          <span>{{weaponMap[weapon.name].range}}</span>
                        </span>
                        <span class="shots">
                          <img src="assets/common/shots.png" alt="Shots" />
                          <span>{{weaponMap[weapon.name].shots}}</span>
                        </span>
                        <span *ngIf="weaponMap[weapon.name].blast" class="blast">
                          <img src="assets/common/blast.png" alt="Blast" />
                          <span>{{weaponMap[weapon.name].blast}}</span>
                        </span>
                        <span *ngIf="weaponMap[weapon.name].hitVehicle" class="hit-vehicle">
                          <img src="assets/common/hit-armor.png" alt="Hit Vehicle" />
                          <span>{{weaponMap[weapon.name].hitVehicle}}</span>
                        </span>
                        <span *ngIf="weaponMap[weapon.name].hitInfantry" class="hit-infantry">
                          <img src="assets/common/hit-infantry.png" alt="Hit Infantry" />
                          <span>{{weaponMap[weapon.name].hitInfantry}}</span>
                        </span>
                        <span *ngIf="weaponMap[weapon.name].damage" class="damage">
                          <img src="assets/common/damage.png" alt="Damage" />
                          <span>{{weaponMap[weapon.name].damage}}</span>
                        </span>

                      </div>
                      <span *ngIf="weapon.qty > 1">{{weapon.qty}}x </span>
                      {{weapon.name}}
                    </div>
                    <div class="clearfix"></div>
                    <div *ngFor="let special of weaponMap[weapon.name].special" class="weapon-special" [innerHTML]="replaceIcons(special)"></div>
                  </div>
                </div>
              </div>
              <div class="unit-stats">
                <div class="move stat">
                  <img src="assets/common/move.png" alt="Movement" />
                  <span>{{activeSquad.data.move}}cm</span>
                </div>
                <div class="defense stat">
                  <img *ngIf="activeSquad.data.type === 'infantry'" src="assets/common/infantry-defense.png" alt="Defense" />
                  <img *ngIf="activeSquad.data.type !== 'infantry'" src="assets/common/vehicle-defense.png" alt="Defense" />
                  <span>{{activeSquad.data.armor}}</span>
                </div>
                <div class="comms stat">
                  <ng-container *ngIf="activeSquad.data.shout" >
                    <img src="assets/common/shout.png" alt="Shout" />
                    <span>{{activeSquad.data.shout}}</span>
                  </ng-container>
                  <ng-container *ngIf="activeSquad.data.runner">
                    <img  src="assets/common/runner.png" alt="Runner" />
                    <span>{{activeSquad.data.runner}}</span>
                  </ng-container>
                  <ng-container *ngIf="activeSquad.data.radio">
                    <img src="assets/common/radio.png" alt="Radio" />
                    <span>{{activeSquad.data.radio}}</span>
                  </ng-container>
                </div>

                <div class="morale stat">
                  <img src="assets/common/morale.png" alt="Morale" />
                  <span>{{activeSquad.data.morale}} / {{activeSquad.data.moraleFrequency}}</span>
                </div>
                <div class="hp stat">
                  <img src="assets/common/hp.png" alt="Hit Points" />
                  <span>{{activeSquad.data.hp}}</span>
                </div>
                <div class="close-combat stat">
                  <img src="assets/common/close-combat.png" alt="Close Combat" />
                  <span>{{activeSquad.data.closeCombat}}</span>
                </div>

                <div class="characteristics">
                  <h3>CHARACTERISTICS</h3>
                  <p>{{activeSquad.data.characteristics}}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
